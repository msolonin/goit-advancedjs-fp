{"version":3,"file":"index.js","sources":["../src/js/filters.js"],"sourcesContent":["import { request } from './services/api-service';\nimport { currentResolution } from './utils/utils.js';\nimport { renderExercises } from './exercises.js';\nimport { LoadListenersForOpenModal } from './modal.js';\n\nconst filterButtons = document.querySelectorAll('.filter-button');\nconst searchForm = document.querySelector('#search-form');\nconst searchInput = document.querySelector('#filter-search');\nconst clearButton = document.querySelector('.button-clear');\nconst filterPagination = document.querySelector('.filter-pagination');\nconst filterTitle = document.querySelector('.filter-title');\nconst filterSubTitle = document.querySelector('.filter-subtitle');\nconst filterCategory = document.querySelector('.filter-title-category');\nconst exercisesContainer = document.querySelector('.exercises-container');\nconst loaderDonat = document.querySelector('.js-loader');\n\nlet requestBase = { path: 'filters', params: { filter: 'Muscles' } };\nlet filterPage = 1;\nlet filterLimit = 9;\nlet lastResolution = currentResolution;\nlet filterSelectedCategory = '';\n\nfunction drawCategories(data) {\n  const categoriesContainer = document.querySelector('.category-items');\n  categoriesContainer.innerHTML = '';\n  categoriesContainer.style.display = 'grid';\n  searchForm.classList.remove('visible')\n\n  data.results.forEach(category => {\n    let li = document.createElement('li');\n    let divItem = document.createElement('div');\n    li.classList.add('category-item');\n    li.style.backgroundImage = `linear-gradient(0deg, rgba(17, 17, 17, 0.50) 0%, rgba(17, 17, 17, 0.50) 100%), url(${category.imgURL})`;\n\n    let categoryText = document.createElement('p');\n    categoryText.innerHTML =\n      category.name.charAt(0).toUpperCase() + category.name.slice(1);\n    categoryText.classList.add('filter-category');\n    divItem.appendChild(categoryText);\n\n    let filterText = document.createElement('p');\n    filterText.innerHTML =\n      category.filter.charAt(0).toUpperCase() + category.filter.slice(1);\n    filterText.classList.add('filter-text');\n    divItem.appendChild(filterText);\n\n    li.addEventListener('click', () => {\n      categoriesContainer.innerHTML = '';\n      categoriesContainer.style.display = 'none';\n      filterSelectedCategory = category.name;\n      updateTitle();\n      handleSearch();\n    });\n\n    li.appendChild(divItem);\n    categoriesContainer.appendChild(li);\n  });\n}\n\nfunction drawContent(data) {\n  if (!filterSelectedCategory) {\n    drawCategories(data);\n  }\n}\n\n// Process the current request\nasync function processCurrentRequest(shouldDraw = true) {\n  const params = {\n    ...requestBase.params,\n    page: filterPage,\n    limit: filterLimit,\n  };\n  loaderDonat.classList.remove('is-hidden');\n  const data = await request(requestBase.path, params);\n  if (shouldDraw) {\n    drawContent(data);\n  }\n  loaderDonat.classList.add('is-hidden');\n  return data;\n}\n\nfunction updateTitle() {\n  if (filterSelectedCategory) {\n    filterSubTitle.classList.add('visible')\n    filterCategory.innerHTML = filterSelectedCategory\n  } else {\n    filterSubTitle.classList.remove('visible')\n  }\n}\n\nfunction updateActivePaginationButton() {\n  const buttons = document.querySelectorAll('.filters-pagination-button');\n  buttons.forEach(btn => {\n    btn.classList.remove('filters-pagination-button-active');\n    if (parseInt(btn.innerHTML) === filterPage) {\n      btn.classList.add('filters-pagination-button-active');\n    }\n  });\n}\n\nconst handlePaginationButtonClick = async (btn, forceProcess = false) => {\n  // Do not process the request if the button is already active\n  if (\n    !forceProcess &&\n    btn.classList.contains('filters-pagination-button-active')\n  ) {\n    return;\n  }\n  filterPage = parseInt(btn.innerHTML);\n  updateActivePaginationButton();\n  await processCurrentRequest();\n};\n\nasync function drawPagination(shouldDraw = false) {\n  // Clear the pagination\n  filterPagination.innerHTML = '';\n  // Get total number of pages(filters=2,exercises=3)\n  const data = await processCurrentRequest(shouldDraw);\n  const totalPages = data.totalPages;\n  // Add <li> to the pagination for each counter while button inside\n  for (let i = 1; i <= totalPages; i++) {\n    const li = document.createElement('li');\n    const button = document.createElement('button');\n    button.innerHTML = i;\n    button.classList.add('filters-pagination-button');\n    li.appendChild(button);\n    filterPagination.appendChild(li);\n  }\n  // Add event listener to all buttons\n  const buttons = document.querySelectorAll('.filters-pagination-button');\n  buttons.forEach(btn => {\n    btn.addEventListener('click', () => {\n      handlePaginationButtonClick(btn);\n    });\n  });\n  // Set active button with page = filterPage\n  updateActivePaginationButton();\n  // Press active button to draw the content\n  handlePaginationButtonClick(\n    document.querySelector('.filters-pagination-button-active'),\n    true\n  );\n}\n\nfunction calculateFilterLimit() {\n  if (filterTitle.innerHTML === 'Exercises') {\n    switch (currentResolution) {\n      case 0:\n        filterLimit = 9;\n        break;\n      case 1:\n        filterLimit = 12;\n        break;\n      case 2:\n        filterLimit = 12;\n        break;\n    }\n  } else {\n    switch (currentResolution) {\n      case 0:\n        filterLimit = 8;\n        break;\n      case 1:\n        filterLimit = 10;\n        break;\n      case 2:\n        filterLimit = 10;\n        break;\n    }\n  }\n}\n\nconst handleFilterButtonClick = async btn => {\n  exercisesContainer.innerHTML = '';\n  filterSelectedCategory = '';\n  filterPage = 1;\n  // Get filter\n  const filter = btn.innerHTML.trim();\n  // Get limit\n  calculateFilterLimit();\n  // Remove filter-button-active for all buttons\n  filterButtons.forEach(btn => {\n    btn.classList.remove('filter-button-active');\n  });\n  // Add filter-button-active to the clicked button\n  btn.classList.add('filter-button-active');\n\n  requestBase = { path: 'filters', params: { filter } };\n  updateTitle();\n  await drawPagination(true);\n};\n\n// Register all the filter-button clicks to the handleFilterButtonClick function\nfilterButtons.forEach(btn => {\n  btn.addEventListener('click', () => {\n    handleFilterButtonClick(btn);\n  });\n});\n\n// OnPageLoaded -> press default active button\ndocument.addEventListener('DOMContentLoaded', async () => {\n  const musclesButton = document.querySelector('.filter-button-active');\n  handleFilterButtonClick(musclesButton);\n});\n\n// Redraw on resolution change\naddEventListener('resize', async () => {\n  if (currentResolution === lastResolution) {\n    return;\n  }\n  lastResolution = currentResolution;\n  calculateFilterLimit();\n  await drawPagination();\n});\n\nfunction toggleClearButton() {\n  if (searchInput.value.trim() !== '') {\n    clearButton.style.visibility = 'visible';\n  } else {\n    clearButton.style.visibility = 'hidden';\n  }\n}\n\nsearchForm.addEventListener('submit', async e => {\n  e.preventDefault();\n  await handleSearch();\n});\n\nclearButton.addEventListener('click', () => {\n  searchInput.value = '';\n  toggleClearButton();\n  requestBase.params.search = '';\n  drawPagination();\n});\n\nconst handleSearch = async () => {\n  const searchQuery = searchInput.value.trim();\n\n  const selectedGroup = document.querySelector('.filter-button-active').value;\n\n  const searchParams = {\n    [selectedGroup]: filterSelectedCategory,\n  };\n  if (searchQuery !== '') {\n    searchParams.keyword = searchQuery;\n  }\n\n  filterPage = 1;\n\n  const exercises = await request('exercises', searchParams);\n  if (exercises.totalPages === null) {\n    filterPagination.innerHTML = '';\n  }\n\n  searchForm.classList.add(\"visible\");\n  renderExercises(exercises, false);\n  LoadListenersForOpenModal();\n\n  searchInput.value = '';\n  toggleClearButton();\n};\n\nsearchInput.addEventListener('input', () => {\n  toggleClearButton();\n});"],"names":["filterButtons","searchForm","searchInput","clearButton","filterPagination","filterTitle","filterSubTitle","filterCategory","exercisesContainer","loaderDonat","requestBase","filterPage","filterLimit","lastResolution","currentResolution","filterSelectedCategory","drawCategories","data","categoriesContainer","category","li","divItem","categoryText","filterText","updateTitle","handleSearch","drawContent","processCurrentRequest","shouldDraw","params","request","updateActivePaginationButton","btn","handlePaginationButtonClick","forceProcess","drawPagination","totalPages","i","button","calculateFilterLimit","handleFilterButtonClick","filter","musclesButton","toggleClearButton","searchQuery","searchParams","exercises","renderExercises","LoadListenersForOpenModal"],"mappings":"uGAKA,MAAMA,EAAgB,SAAS,iBAAiB,gBAAgB,EAC1DC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAmB,SAAS,cAAc,oBAAoB,EAC9DC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAiB,SAAS,cAAc,kBAAkB,EAC1DC,EAAiB,SAAS,cAAc,wBAAwB,EAChEC,EAAqB,SAAS,cAAc,sBAAsB,EAClEC,EAAc,SAAS,cAAc,YAAY,EAEvD,IAAIC,EAAc,CAAE,KAAM,UAAW,OAAQ,CAAE,OAAQ,SAAS,GAC5DC,EAAa,EACbC,EAAc,EACdC,EAAiBC,EACjBC,EAAyB,GAE7B,SAASC,EAAeC,EAAM,CAC5B,MAAMC,EAAsB,SAAS,cAAc,iBAAiB,EACpEA,EAAoB,UAAY,GAChCA,EAAoB,MAAM,QAAU,OACpCjB,EAAW,UAAU,OAAO,SAAS,EAErCgB,EAAK,QAAQ,QAAQE,GAAY,CAC/B,IAAIC,EAAK,SAAS,cAAc,IAAI,EAChCC,EAAU,SAAS,cAAc,KAAK,EAC1CD,EAAG,UAAU,IAAI,eAAe,EAChCA,EAAG,MAAM,gBAAkB,sFAAsFD,EAAS,MAAM,IAEhI,IAAIG,EAAe,SAAS,cAAc,GAAG,EAC7CA,EAAa,UACXH,EAAS,KAAK,OAAO,CAAC,EAAE,cAAgBA,EAAS,KAAK,MAAM,CAAC,EAC/DG,EAAa,UAAU,IAAI,iBAAiB,EAC5CD,EAAQ,YAAYC,CAAY,EAEhC,IAAIC,EAAa,SAAS,cAAc,GAAG,EAC3CA,EAAW,UACTJ,EAAS,OAAO,OAAO,CAAC,EAAE,cAAgBA,EAAS,OAAO,MAAM,CAAC,EACnEI,EAAW,UAAU,IAAI,aAAa,EACtCF,EAAQ,YAAYE,CAAU,EAE9BH,EAAG,iBAAiB,QAAS,IAAM,CACjCF,EAAoB,UAAY,GAChCA,EAAoB,MAAM,QAAU,OACpCH,EAAyBI,EAAS,KAClCK,IACAC,GACN,CAAK,EAEDL,EAAG,YAAYC,CAAO,EACtBH,EAAoB,YAAYE,CAAE,CACtC,CAAG,CACH,CAEA,SAASM,EAAYT,EAAM,CACpBF,GACHC,EAAeC,CAAI,CAEvB,CAGA,eAAeU,EAAsBC,EAAa,GAAM,CACtD,MAAMC,EAAS,CACb,GAAGnB,EAAY,OACf,KAAMC,EACN,MAAOC,CACX,EACEH,EAAY,UAAU,OAAO,WAAW,EACxC,MAAMQ,EAAO,MAAMa,EAAQpB,EAAY,KAAMmB,CAAM,EACnD,OAAID,GACFF,EAAYT,CAAI,EAElBR,EAAY,UAAU,IAAI,WAAW,EAC9BQ,CACT,CAEA,SAASO,GAAc,CACjBT,GACFT,EAAe,UAAU,IAAI,SAAS,EACtCC,EAAe,UAAYQ,GAE3BT,EAAe,UAAU,OAAO,SAAS,CAE7C,CAEA,SAASyB,GAA+B,CACtB,SAAS,iBAAiB,4BAA4B,EAC9D,QAAQC,GAAO,CACrBA,EAAI,UAAU,OAAO,kCAAkC,EACnD,SAASA,EAAI,SAAS,IAAMrB,GAC9BqB,EAAI,UAAU,IAAI,kCAAkC,CAE1D,CAAG,CACH,CAEA,MAAMC,EAA8B,MAAOD,EAAKE,EAAe,KAAU,CAGrE,CAACA,GACDF,EAAI,UAAU,SAAS,kCAAkC,IAI3DrB,EAAa,SAASqB,EAAI,SAAS,EACnCD,IACA,MAAMJ,EAAqB,EAC7B,EAEA,eAAeQ,EAAeP,EAAa,GAAO,CAEhDxB,EAAiB,UAAY,GAG7B,MAAMgC,GADO,MAAMT,EAAsBC,CAAU,GAC3B,WAExB,QAASS,EAAI,EAAGA,GAAKD,EAAYC,IAAK,CACpC,MAAMjB,EAAK,SAAS,cAAc,IAAI,EAChCkB,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,UAAYD,EACnBC,EAAO,UAAU,IAAI,2BAA2B,EAChDlB,EAAG,YAAYkB,CAAM,EACrBlC,EAAiB,YAAYgB,CAAE,CAChC,CAEe,SAAS,iBAAiB,4BAA4B,EAC9D,QAAQY,GAAO,CACrBA,EAAI,iBAAiB,QAAS,IAAM,CAClCC,EAA4BD,CAAG,CACrC,CAAK,CACL,CAAG,EAEDD,IAEAE,EACE,SAAS,cAAc,mCAAmC,EAC1D,EACJ,CACA,CAEA,SAASM,GAAuB,CAC9B,GAAIlC,EAAY,YAAc,YAC5B,OAAQS,EAAiB,CACvB,IAAK,GACHF,EAAc,EACd,MACF,IAAK,GACHA,EAAc,GACd,MACF,IAAK,GACHA,EAAc,GACd,KACH,KAED,QAAQE,EAAiB,CACvB,IAAK,GACHF,EAAc,EACd,MACF,IAAK,GACHA,EAAc,GACd,MACF,IAAK,GACHA,EAAc,GACd,KACH,CAEL,CAEA,MAAM4B,EAA0B,MAAMR,GAAO,CAC3CxB,EAAmB,UAAY,GAC/BO,EAAyB,GACzBJ,EAAa,EAEb,MAAM8B,EAAST,EAAI,UAAU,KAAI,EAEjCO,IAEAvC,EAAc,QAAQgC,GAAO,CAC3BA,EAAI,UAAU,OAAO,sBAAsB,CAC/C,CAAG,EAEDA,EAAI,UAAU,IAAI,sBAAsB,EAExCtB,EAAc,CAAE,KAAM,UAAW,OAAQ,CAAE,OAAA+B,CAAM,GACjDjB,IACA,MAAMW,EAAe,EAAI,CAC3B,EAGAnC,EAAc,QAAQgC,GAAO,CAC3BA,EAAI,iBAAiB,QAAS,IAAM,CAClCQ,EAAwBR,CAAG,CAC/B,CAAG,CACH,CAAC,EAGD,SAAS,iBAAiB,mBAAoB,SAAY,CACxD,MAAMU,EAAgB,SAAS,cAAc,uBAAuB,EACpEF,EAAwBE,CAAa,CACvC,CAAC,EAGD,iBAAiB,SAAU,SAAY,CACjC5B,IAAsBD,IAG1BA,EAAiBC,EACjByB,IACA,MAAMJ,EAAc,EACtB,CAAC,EAED,SAASQ,GAAoB,CACvBzC,EAAY,MAAM,KAAI,IAAO,GAC/BC,EAAY,MAAM,WAAa,UAE/BA,EAAY,MAAM,WAAa,QAEnC,CAEAF,EAAW,iBAAiB,SAAU,MAAM,GAAK,CAC/C,EAAE,eAAc,EAChB,MAAMwB,EAAY,CACpB,CAAC,EAEDtB,EAAY,iBAAiB,QAAS,IAAM,CAC1CD,EAAY,MAAQ,GACpByC,IACAjC,EAAY,OAAO,OAAS,GAC5ByB,GACF,CAAC,EAED,MAAMV,EAAe,SAAY,CAC/B,MAAMmB,EAAc1C,EAAY,MAAM,KAAI,EAIpC2C,EAAe,CACnB,CAHoB,SAAS,cAAc,uBAAuB,EAAE,KAGtD,EAAG9B,CACrB,EACM6B,IAAgB,KAClBC,EAAa,QAAUD,GAGzBjC,EAAa,EAEb,MAAMmC,EAAY,MAAMhB,EAAQ,YAAae,CAAY,EACrDC,EAAU,aAAe,OAC3B1C,EAAiB,UAAY,IAG/BH,EAAW,UAAU,IAAI,SAAS,EAClC8C,EAAgBD,EAAW,EAAK,EAChCE,IAEA9C,EAAY,MAAQ,GACpByC,GACF,EAEAzC,EAAY,iBAAiB,QAAS,IAAM,CAC1CyC,GACF,CAAC"}