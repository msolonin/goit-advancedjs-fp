{"version":3,"file":"index.js","sources":["../src/js/filters.js","../src/js/utils/local-storage.js","../src/js/modal.js"],"sourcesContent":["import { request } from './services/api-service';\nimport { currentResolution } from './utils/utils.js';\n\nconst filterButtons = document.querySelectorAll('.filter-button');\nconst filterPagination = document.querySelector('.filter-pagination');\n\nlet requestBase = { path: 'filters', params: { filter: 'Muscles' } };\nlet filterPage = 1;\nlet filterLimit = 9;\nlet lastResolution = currentResolution;\n\nfunction drawFilterContent(data) {\n  // TODO: Draw the content based on the data\n  console.log(data);\n}\n\n// Process the current request\nasync function processCurrentRequest(shouldDraw = true) {\n  const params = {\n    ...requestBase.params,\n    page: filterPage,\n    limit: filterLimit,\n  };\n  const data = await request(requestBase.path, params);\n  if (shouldDraw) {\n    drawFilterContent(data);\n  }\n  return data;\n}\n\nfunction updateTitle() {\n  const title = document.querySelector('.filter-title');\n  if (requestBase.path === 'filters') {\n    title.innerHTML = 'Exercises';\n  }\n}\n\nfunction updateActivePaginationButton() {\n  const buttons = document.querySelectorAll('.filters-pagination-button');\n  buttons.forEach(btn => {\n    btn.classList.remove('filters-pagination-button-active');\n    if (parseInt(btn.innerHTML) === filterPage) {\n      btn.classList.add('filters-pagination-button-active');\n    }\n  });\n}\n\nconst handlePaginationButtonClick = async (btn, forceProcess = false) => {\n  // Do not process the request if the button is already active\n  if (\n    !forceProcess &&\n    btn.classList.contains('filters-pagination-button-active')\n  ) {\n    return;\n  }\n  filterPage = parseInt(btn.innerHTML);\n  updateActivePaginationButton();\n  await processCurrentRequest();\n};\n\nasync function drawPagination() {\n  // Clear the pagination\n  filterPagination.innerHTML = '';\n  // Get total number of pages(filters=2,exercises=3)\n  const data = await processCurrentRequest(false);\n  const totalPages = data.totalPages;\n  // Add <li> to the pagination for each counter while button inside\n  for (let i = 1; i <= totalPages; i++) {\n    const li = document.createElement('li');\n    const button = document.createElement('button');\n    button.innerHTML = i;\n    button.classList.add('filters-pagination-button');\n    li.appendChild(button);\n    filterPagination.appendChild(li);\n  }\n  // Add event listener to all buttons\n  const buttons = document.querySelectorAll('.filters-pagination-button');\n  buttons.forEach(btn => {\n    btn.addEventListener('click', () => {\n      handlePaginationButtonClick(btn);\n    });\n  });\n  // Set active button with page = filterPage\n  updateActivePaginationButton();\n  // Press active button to draw the content\n  handlePaginationButtonClick(\n    document.querySelector('.filters-pagination-button-active'),\n    true\n  );\n}\n\nfunction calculateFilterLimit() {\n  switch (currentResolution) {\n    case 0:\n      filterLimit = 9;\n      break;\n    case 1:\n      filterLimit = 12;\n      break;\n    case 2:\n      filterLimit = 12;\n      break;\n  }\n}\n\nconst handleFilterButtonClick = async btn => {\n  filterPage = 1;\n  // Get filter\n  const filter = btn.innerHTML;\n  // Get limit\n  calculateFilterLimit();\n  // Remove filter-button-active for all buttons\n  filterButtons.forEach(btn => {\n    btn.classList.remove('filter-button-active');\n  });\n  // Add filter-button-active to the clicked button\n  btn.classList.add('filter-button-active');\n\n  requestBase = { path: 'filters', params: { filter } };\n  updateTitle();\n  await drawPagination();\n};\n\n// Register all the filter-button clicks to the handleFilterButtonClick function\nfilterButtons.forEach(btn => {\n  btn.addEventListener('click', () => {\n    handleFilterButtonClick(btn);\n  });\n});\n\n// OnPageLoaded -> press default active button\ndocument.addEventListener('DOMContentLoaded', async () => {\n  const musclesButton = document.querySelector('.filter-button-active');\n  handleFilterButtonClick(musclesButton);\n});\n\n// Redraw on resolution change\naddEventListener('resize', async () => {\n  if (currentResolution === lastResolution) {\n    return;\n  }\n  lastResolution = currentResolution;\n  calculateFilterLimit();\n  await drawPagination();\n});\n","// Returns Array\nexport function GetFavorites() {\n    return JSON.parse(localStorage.getItem(\"favorites\")) ?? [];\n}\n\nexport function AddToFavorites(exerciseID) {\n    const favorites = JSON.parse(localStorage.getItem(\"favorites\")) ?? [];\n    favorites.push(exerciseID);\n    localStorage.setItem(\"favorites\", JSON.stringify(favorites));\n}\n\nexport function RemoveFromFavorites(exerciseID) {\n    const favorites = JSON.parse(localStorage.getItem(\"favorites\")) ?? [];\n    favorites.splice(favorites.indexOf(exerciseID));\n    localStorage.setItem(\"favorites\", JSON.stringify(favorites));\n}","import { GetFavorites, AddToFavorites, RemoveFromFavorites } from \"./utils/local-storage.js\";\nimport { request } from \"./services/api-service.js\";\n\nconst btnOpenModal = document.querySelectorAll(\"[data-modal-open]\");\nconst btnCloseModal = document.querySelector(\"[data-modal-close]\");\nconst modalWindow = document.querySelector(\".modal\"); // Modal without backdrop\nconst modal = document.querySelector(\"[data-modal]\"); // Modal with backdrop\n\n// let exerciseID = '64f389465ae26083f39b18d7'; // ID of the exercise TEST\nfor (let i = 0; i < btnOpenModal.length; i++) {\n    btnOpenModal[i].addEventListener(\"click\", (event) => {\n        const btn = event.target;\n        const exerciseID = btn.value;\n        LoadData(exerciseID);\n    });  \n}\n\nasync function LoadData(exerciseID) {\n    const exerciseData = await request(`exercises/${exerciseID}`);\n    LoadElementsData(exerciseData);\n    \n    // Add to favorites btn functions\n    const btnAddFavorites = document.querySelector(\".btn-modal-add-fav\");\n    \n    // Check local storage if it contains exercise\n    // localStorage.setItem(\"favorites\", JSON.stringify([1])); // For test\n    if (GetFavorites().indexOf(exerciseID) >= 0) {\n        btnAddFavorites.classList.add(\"fav-added\");\n        document.querySelector(\".btn-fav-text\").textContent = \"Remove from favorites\";\n        document.querySelector(\".icon-fav-btn-use\").setAttribute(\"href\", \"./img/icons.svg#icon-trash\");\n    }\n    \n    btnAddFavorites.addEventListener(\"click\", (event) => {\n        btnAddFavorites.classList.toggle(\"fav-added\");\n        \n        if (btnAddFavorites.classList.contains(\"fav-added\")) {\n            AddToFavorites(exerciseID);\n            document.querySelector(\".btn-fav-text\").textContent = \"Remove from favorites\";\n            document.querySelector(\".icon-fav-btn-use\").setAttribute(\"href\", \"./img/icons.svg#icon-trash\");\n        }\n        else {\n            RemoveFromFavorites(exerciseID);\n            document.querySelector(\".btn-fav-text\").textContent = \"Add to favorites\";\n            document.querySelector(\".icon-fav-btn-use\").setAttribute(\"href\", \"./img/icons.svg#icon-heart\");\n        }\n    })\n\n    modal.classList.toggle(\"hidden\");\n    OnOpen();\n};\n\nfunction LoadElementsData(exerciseData) {\n    document.querySelector(\".img-modal-exercise\").src = exerciseData.gifUrl;\n    document.querySelector(\".title-modal\").textContent = exerciseData.name.trim();\n    document.querySelector(\".desc-text\").textContent = exerciseData.description.trim();\n    \n    // Stars fill color\n    document.querySelector(\".rating-value\").textContent = exerciseData.rating;\n    // Full stars\n    const stars = document.querySelectorAll(\".icon-modal-star\");\n    const wholePartRating = Math.floor(exerciseData.rating);\n    for (let i = 0; i < wholePartRating; i++)\n        stars[i].classList.add(\"gold\");\n\n    // Half star\n    const fractionPartRating = Math.floor((exerciseData.rating - wholePartRating) * 100);\n    const gradientStops = document.querySelectorAll(\".gradient-middle\");\n    for (let i = 0; i < gradientStops.length; i++)\n        gradientStops[i].setAttribute(\"offset\", `${fractionPartRating}%`);\n    stars[wholePartRating].classList.add(\"gold-half\");\n\n    // Stats\n    const statsList = document.querySelector(\".stats-list\");\n    statsList.innerHTML = \"\";\n    innerHTMLStats = \"\";\n    if(exerciseData.target !== \"\")\n        AddStat(\"Target\", exerciseData.target);\n    if(exerciseData.bodyPart !== \"\")\n        AddStat(\"BodyPart\", exerciseData.bodyPart);\n    if(exerciseData.equipment !== \"\")\n        AddStat(\"Equipment\", exerciseData.equipment);\n    if(exerciseData.popularity !== \"\")\n        AddStat(\"Popular\", exerciseData.popularity);\n    if(exerciseData.burnedCalories !== \"\")\n        AddStat(\"Burned Calories\", exerciseData.burnedCalories + \"/\" + exerciseData.time + \" min\");\n    statsList.insertAdjacentHTML(\"beforeend\", innerHTMLStats);\n}\n\nlet innerHTMLStats = \"\";\nfunction AddStat(title, value) {\n    innerHTMLStats += `<li class=\"stats-item\">\n              <p class=\"stats-title\">${title}</p>\n              <p class=\"stats-value\">${value}</p>\n            </li>`;\n}\n\n\n// Modal close functions\nbtnCloseModal.addEventListener(\"click\", () => {\n    modal.classList.toggle(\"hidden\");\n    OnClose();\n});\n\nmodal.addEventListener(\"click\", (event) => {\n    const rect = modalWindow.getBoundingClientRect();\n    // Define if cursor is in modal window\n    const isInWindow = (rect.top <= event.clientY && event.clientY <= rect.top + rect.height &&\n    rect.left <= event.clientX && event.clientX <= rect.left + rect.width);\n    if (!isInWindow) {\n        modal.classList.toggle(\"hidden\");\n        OnClose();\n    }\n});\n\nfunction escapeKeyDown(event) {\n    if (event.key === \"Escape\") {\n        modal.classList.add(\"hidden\");\n        OnClose();\n    }\n}\n\nfunction OnOpen() {\n    document.addEventListener(\"keydown\", escapeKeyDown);\n    document.querySelector(\"body\").classList.add(\"modal-open\");\n    document.querySelector('.scroll-up-button').style.visibility = 'hidden';\n}\n\nfunction OnClose() {\n    document.removeEventListener(\"keydown\", escapeKeyDown);\n    document.querySelector(\"body\").classList.remove(\"modal-open\");\n    document.querySelector('.scroll-up-button').style.visibility = 'visible';\n}\n\n\n"],"names":["filterButtons","filterPagination","requestBase","filterPage","filterLimit","lastResolution","currentResolution","drawFilterContent","data","processCurrentRequest","shouldDraw","params","request","updateTitle","title","updateActivePaginationButton","btn","handlePaginationButtonClick","forceProcess","drawPagination","totalPages","i","li","button","calculateFilterLimit","handleFilterButtonClick","filter","musclesButton","GetFavorites","AddToFavorites","exerciseID","favorites","RemoveFromFavorites","btnOpenModal","btnCloseModal","modalWindow","modal","event","LoadData","exerciseData","LoadElementsData","btnAddFavorites","OnOpen","stars","wholePartRating","fractionPartRating","gradientStops","statsList","innerHTMLStats","AddStat","value","OnClose","rect","escapeKeyDown"],"mappings":"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"}